# 生產環境配置 - 方案 A（預構建前端）
# 使用方式: docker-compose -f docker-compose.yml -f docker-compose.prod-prebuilt.yml up -d
#
# 特點：
# - 不需要在伺服器上構建前端（適合小規格機器）
# - 使用本地構建好的 dist 目錄
# - 直接使用 nginx:alpine image
# - 部署速度快（秒級）
#
# 前置步驟：
# 1. 在本地構建前端：
#    cd knowledge-admin/frontend
#    npm install
#    npm run build
# 2. 上傳 dist 目錄到伺服器
# 3. 執行此配置啟動服務

services:
  # 知識庫管理後台 - 前端（預構建模式）
  knowledge-admin-web:
    image: nginx:alpine  # 直接使用 nginx image，不構建
    command: ["nginx", "-g", "daemon off;"]
    ports:
      - "80:80"  # 映射到 80 端口
    volumes:
      # 掛載本地已構建的 dist 目錄
      - ./knowledge-admin/frontend/dist:/usr/share/nginx/html:ro
      # 掛載 nginx 配置
      - ./knowledge-admin/frontend/nginx.conf:/etc/nginx/conf.d/default.conf:ro
    restart: unless-stopped
    networks:
      - default
